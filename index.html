<!DOCTYPE html>
<html>

	<head>
		<title>CADETS/OPUD_GUI</title>
		
		<link href="css/style.css" rel="stylesheet" />
		<link href="css/cytoscape.css" rel="stylesheet" />
		<link rel="stylesheet" href="node_modules/vex-js/dist/css/vex.css" />
		<link rel="stylesheet" href="node_modules/vex-js/dist/css/vex-theme-os.css" />

		<script src="node_modules/vex-js/dist/js/vex.combined.min.js"></script>
		<script src="node_modules/jquery/dist/jquery.js"></script>
		<script src="node_modules/cytoscape/dist/cytoscape.min.js"></script>
		<script src="node_modules/cytoscape-cxtmenu/cytoscape-cxtmenu.js"></script>
		<script src="node_modules/neo4j-driver/lib/browser/neo4j-web.min.js"></script>

		<script src="js/graphing.js"></script>
	</head>

	<body>
		<div class="fill">

			<div class="fillHeader">
				<font class="headerObject" size="+3">CADETS/OPUS</font>
				<div class="headerButtons">
					<button type="button"></button>
					<button type="button" class="headerButton" id="machinesPageBtn">Machines</button>
					<button type="button" class="headerButton" id="notificationsPageBtn">Notifications</button>
					<button type="button" class="headerButton" id="WorksheetPageBtn">Worksheets</button>
				</div>
			</div>

			<div class=fillBody>

				<div class="fill" id="machinePage" >

					<div class="machineGraph" id="machineGraph"></div>
				</div>

				<div class="fill hide" id="notificationPage">
					<table class="notificationTable">
						<thead>
							<tr>
								<th>Time</th>
								<th>Local</th>
								<th>Remote</th>
								<th>Event</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>{{ alert.timestamp }}</td>
								<td>
									<a href="worksheet?nodeType=socket-version&tcp={{ alert.local_ip }}:{{ alert.local_port }}::">{{ alert.local_ip }}:{{ alert.local_port }}
									</a>
								</td>
								<td>
									<a href="worksheet?nodeType=socket-version&tcp=::{{ alert.remote_ip }}:{{ alert.remote_port }}">{{ alert.remote_ip }}:{{ alert.remote_port }}
									</a>
								</td>
								<td>{{ alert.event }}</td>
								<td>
									<a href="worksheet?nodeType=socket-version&tcp={{ alert.local_ip }}:{{ alert.local_port }}:{{ alert.remote_ip }}:{{ alert.remote_port }}">lookup
									</a>
								</td>
							</tr>{% endfor %}
						</tbody>
					</table>
				</div>

				<div class="fill hide" id="worksheetPage">

					<div class="analysisWorksheet" id="analysisWorksheet">
						
						<div class="analysisHeader">&nbsp;Available nodes:
							<form id="nodeFilters" class="form-horizontal well" method="get">
								<fieldset>
									<div class="form-group">
										<label for="filterNodeType" class="col-md-2 control-label">Type</label>
										<div class="col-md-10">
											<select id="filterNodeType" class="form-control">
												<option></option>
												<option>connection</option>
												<option>file-version</option>
												<option>pipe-endpoint</option>
												<option>process</option>
												<option>process-meta</option>
												<option>socket-version</option>
												<option>machine</option>
											</select>
										</div>
										<label for="filterName" class="col-md-2 control-label">Name</label>
										<div class="col-md-10">
											<input id="filterName" class="form-control"/>
										</div>
										<label for="filterHost" class="col-md-2 control-label">Host</label>
										<div class="col-md-10">
											<input id="filterHost" class="form-control"/>
										</div>
										<label for="filterTuple" class="col-md-2 control-label">TCP</label>
										<div id="filterTuple" class="col-md-10">
											<input id="filterLocalIp" size="10"/>
											<input id="filterLocalPort" size="3"/>L<br/>
											<input id="filterRemoteIp" size="10"/>
											<input id="filterRemotePort" size="3"/>R
										</div>
									</div>
								</fieldset>
							</form>
						</div>
						<div class="analysisBody scrollable">
							<table class="table table-hover">
								<tbody id="nodelist"></tbody>
						</table>
						</div>
					</div>

					<div class="worksheet" id="worksheet">
						<div class="fill" id="worksheetGraph"></div>
						<div class="worksheetBtns">
							<button type="button" class="bodyButton" id="hideAnalysisWorksheet">Toggle<br>SideBar</button>
							<input type="file" class="bodyButton" id="loadGraph" value=""></input>
							<button type="button" class="bodyButton" id="saveGraph">saveGraph</button>
							<button type="button" class="bodyButton" id="reDagre">reDagre</button>
							<button type="button" class="bodyButton" id="reCose-Bilkent">reCose</button>
						</div>
					</div>

					<div class="inspector scrollable">
						<div class="fill" id="inspectorGraph"></div>
						<font class="panel-heading" size="+3">&nbsp;Inspector</font>
						<div class="filter">
							<input type="checkbox" id="inspectFiles">Files</input>
							<input type="checkbox" id="inspectSockets">Sockets</input>
							<input type="checkbox" id="inspectPipes">Pipes</input>
							<input type="checkbox" id="inspectProcessMeta">ProcessMetaData</input>
						</div>
						<div class="inspectorT1">
							<font class="panel-heading">Details</font>
							<div class="panel-body scrollable">
								<table id="inspector-detail" class="table table-striped"></table>
							</div>
						</div>
						<div class="inspectorT2">
							<font class="panel-heading">Neighbours</font>
							<div class="panel-body scrollable">
								<table id="neighbour-detail" class="table table-striped"></table>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
		<script src='js/bundle.js'></script>
	</body>
</html>